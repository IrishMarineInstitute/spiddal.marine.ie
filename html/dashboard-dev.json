{
	"version": 1,
	"allow_edit": true,
	"plugins": [],
	"panes": [
		{
			"title": "Spiddal Camera feed (20m)",
			"width": 1,
			"row": {
				"3": 1,
				"4": 1,
				"5": 1,
				"3.5": 1,
				"3.1": 1
			},
			"col": {
				"3": 1,
				"4": 1,
				"5": 1,
				"3.5": 1,
				"3.1": 1
			},
			"col_width": 2.1,
			"widgets": [
				{
					"type": "html",
					"settings": {
						"html": "<div id=\"player\"><video id=\"video\" poster=\"snap.jpg\" autoplay=\"autoplay\" controls=\"controls\">\n    <source src=\"http://spiddal.marine.ie/spidvid/dash/spiddal1.mpd\" type=\"application/dash+xml\">\n    <source src=\"http://spiddal.marine.ie/spidvid/hls/spiddal1.m3u8\" type=\"application/x-mpegURL\">\n    <source src=\"http://spiddal.marine.ie/spidvid/hls/spiddal1.m3u8\" type=\"application/vnd.apple.mpegURL\">\n    Sorry, streaming video not supported in your browser.\n    </video>\n </div>\n<script type=\"text/javascript\">\n  var myVideo = document.createElement('video');\n  if (myVideo.canPlayType(\"application/dash+xml\")\n    .replace(/no/, '') !== \"\" || myVideo.canPlayType(\"application/x-mpegURL\")\n    .replace(/no/, '') !== \"\" || myVideo.canPlayType(\n      \"application/vnd.apple.mpegURL\")\n    .replace(/no/, '') !== \"\") {\n    console.log(\"using default video\");\n     $(\"#video\").removeAttr(\"controls\");\n    document.getElementById('video')\n      .play();\n  } else {\n  $.getScript(\"hls.min.js\")\n   .done(function(script, textStatus) {\n    if (Hls.isSupported()) {\n     console.log(\"using hls.js video\");\n     $(\"#video\").removeAttr(\"controls\");\n     var video = document.getElementById('video');\n     var hls = new Hls();\n     hls.loadSource('http://spiddal.marine.ie/spidvid/hls/spiddal1.m3u8');\n     hls.attachVideo(video);\n     hls.on(Hls.Events.MANIFEST_PARSED, function() {\n      video.play();\n     });\n    } else {\n\n     var hasFlash = false;\n     try {\n      var fo = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\n      if (fo) {\n       hasFlash = true;\n      }\n     } catch (e) {\n      if (navigator.mimeTypes && navigator.mimeTypes[\n        'application/x-shockwave-flash'] != undefined && navigator.mimeTypes[\n        'application/x-shockwave-flash'].enabledPlugin) {\n       hasFlash = true;\n      }\n     }\n     if (hasFlash) {\n      var width = $(\"#player\").width();\n      var height = $(\"#player\").height();\n      $(\"#player\").empty();\n      $(\"#player\").append('<a style=\"display: block; width: 640px; height: 360px;\" id=\"video\"></a>');\n      \n\n      $.when(\n        $.getScript(\"flowplayer-3.2.12.min.js\"),\n        $.getScript(\"libs/js2flash.js\"),\n        $.getScript(\"libs/JSLoaderFragment.js\"),\n        $.getScript(\"libs/JSLoaderPlaylist.js\"),\n        $.Deferred(function(deferred) {\n         $(deferred.resolve);\n        })\n       )\n       .done(function() {\n         flowplayer(\"video\", \"flowplayer.swf\", {\n         wmode: 'direct',\n         plugins: {\n          httpstreaming: {\n           url: 'flashlsFlowPlayer.swf',\n           hls_debug: false,\n           hls_debug2: false,\n           hls_lowbufferlength: 3,\n           hls_minbufferlength: -1,\n           hls_maxbufferlength: 300,\n           hls_startfromlevel: -1,\n           hls_seekfromlevel: -1,\n           hls_live_flushurlcache: false,\n           hls_seekmode: \"ACCURATE\",\n           hls_fragmentloadmaxretry: -1,\n           hls_manifestloadmaxretry: -1,\n           hls_capleveltostage: false,\n           hls_maxlevelcappingmode: \"downscale\"\n          }\n         },\n         clip: {\n          accelerated: true,\n           url: \"http://spiddal.marine.ie/spidvid/hls/spiddal1.m3u8\",\n          urlResolvers: \"httpstreaming\",\n          lang: \"en\",\n          provider: \"httpstreaming\",\n          autoPlay: false,\n          autoBuffering: true\n         },\n         log: {\n          level: 'debug',\n          filter: 'org.flowplayer.controller.*'\n         }\n        });\n       });\n     }\n    }\n   });\n\n  }\n</script>",
						"height": 6
					}
				}
			]
		},
		{
			"title": "spiddal.marine.ie",
			"width": 1,
			"row": {
				"3": 1,
				"4.1": 1
			},
			"col": {
				"3": 3,
				"4.1": 3
			},
			"col_width": 1,
			"widgets": [
				{
					"type": "html",
					"settings": {
						"html": "<div style=\"padding: 10px\"><a href=\"//www.marine.ie\"><img src=\"//data.marine.ie/Content/Images/MI%20logo%20_%20ALL%20WHITE_inverted_Trasnparent_212x54.png\" alt=\"Marine Institute\" ></a>\n<p>\nThis site provides live and archived data from the Atlantic Ocean cabled undersea observatory beneath Galway Bay, just off Spiddal, Co. Galway, Ireland.\n</p>\n<p>\nResearchers please Â see <a href=\"data.html\">spiddal.marine.ie/data.html</a> for details about data format, and download links.\n</p><p>Note this site works best in chrome browser.</p></div>\n",
						"height": 4
					}
				}
			]
		},
		{
			"title": "Galway Weather",
			"width": 1,
			"row": {
				"3": 11,
				"4": 15,
				"5": 15,
				"3.5": 15,
				"4.1": 15
			},
			"col": {
				"3": 3,
				"4": 1,
				"5": 1,
				"3.5": 1,
				"4.1": 1
			},
			"col_width": 1,
			"widgets": [
				{
					"type": "text_widget",
					"settings": {
						"title": "Sunrise",
						"size": "regular",
						"value": "datasources[\"Galway\"][\"sunrise\"]",
						"animate": true
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "Sunset",
						"size": "regular",
						"value": "datasources[\"Galway\"][\"sunset\"]",
						"animate": true
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "Galway Current Air Temperature",
						"size": "regular",
						"value": "datasources[\"Galway\"][\"current_temp\"]",
						"animate": true,
						"units": "&degC"
					}
				},
				{
					"type": "sparkline",
					"settings": {
						"title": "Air temp",
						"value": [
							"datasources[\"Galway\"][\"current_temp\"]"
						],
						"include_legend": false
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "Condtions",
						"size": "regular",
						"value": "datasources[\"Galway\"][\"conditions\"]",
						"animate": true
					}
				}
			]
		},
		{
			"title": "WetLabs Fluorometer",
			"width": 1,
			"row": {
				"3": 15,
				"4": 15,
				"5": 15,
				"4.1": 15
			},
			"col": {
				"3": 2,
				"4": 2,
				"5": 2,
				"4.1": 2
			},
			"col_width": 1,
			"widgets": [
				{
					"type": "text_widget",
					"settings": {
						"title": "Last reading",
						"size": "regular",
						"value": "datasources[\"spidFluor\"][\"Time\"]",
						"animate": true,
						"units": ""
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "Chlorophyll Concentration",
						"size": "regular",
						"value": "datasources[\"spidFluor\"][\"CHL\"]",
						"sparkline": true,
						"animate": true,
						"units": "&micro;g&#47;l"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "Nephelometric Turbidity Unit (NTU)",
						"size": "regular",
						"value": "datasources[\"spidFluor\"][\"NTU\"]",
						"sparkline": true,
						"animate": true,
						"units": "NTU"
					}
				},
				{
					"type": "sparkline",
					"settings": {
						"title": "Graph",
						"value": [
							"datasources[\"spidFluor\"][\"CHL\"]",
							"datasources[\"spidFluor\"][\"NTU\"]"
						],
						"include_legend": true,
						"legend": "CHL,NTU"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "CHL",
						"size": "regular",
						"value": "datasources[\"spidFluor\"][\"CHLCount\"]",
						"sparkline": true,
						"animate": true,
						"units": "counts"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "NTU",
						"size": "regular",
						"value": "datasources[\"spidFluor\"][\"NTUCount\"]",
						"sparkline": true,
						"animate": true,
						"units": "counts"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "Flourescence wavelength",
						"size": "regular",
						"value": "datasources[\"spidFluor\"][\"FluorescenceWavelength\"]",
						"animate": true,
						"units": "nm"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "Turbidity Wavelength",
						"size": "regular",
						"value": "datasources[\"spidFluor\"][\"TurbidityWavelength\"]",
						"animate": true,
						"units": "nm"
					}
				}
			]
		},
		{
			"title": "Spiddal Observatory CTD",
			"width": 1,
			"row": {
				"3": 15,
				"4": 1,
				"5": 1,
				"4.1": 1
			},
			"col": {
				"3": 1,
				"4": 3,
				"5": 3,
				"4.1": 1
			},
			"col_width": 1,
			"widgets": [
				{
					"type": "text_widget",
					"settings": {
						"title": "time of last record",
						"size": "regular",
						"value": "datasources[\"ctd\"][\"Time\"].substring(0,8)",
						"sparkline": false,
						"animate": true
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "sea water temperature (20m)",
						"size": "regular",
						"value": "datasources[\"ctd\"][\"Temp\"]",
						"sparkline": true,
						"animate": true,
						"units": "&deg;C"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "salinity",
						"size": "regular",
						"value": "datasources[\"ctd\"][\"Sal\"]",
						"sparkline": true,
						"animate": true,
						"units": "PSU"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "pressure",
						"size": "regular",
						"value": "datasources[\"ctd\"][\"Press\"]",
						"sparkline": true,
						"animate": true,
						"units": "dbar"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "sound velocity",
						"size": "regular",
						"value": "datasources[\"ctd\"][\"SoundV\"]",
						"sparkline": true,
						"animate": true,
						"units": "m/s"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "conductivity",
						"size": "regular",
						"value": "datasources[\"ctd\"][\"Cond\"]",
						"sparkline": true,
						"animate": true,
						"units": "mS/cm"
					}
				}
			]
		},
		{
			"title": "Galway Wave Buoy",
			"width": 1,
			"row": {
				"3": 25,
				"4": 21,
				"5": 21,
				"4.1": 15
			},
			"col": {
				"3": 3,
				"4": 3,
				"5": 3,
				"4.1": 1
			},
			"col_width": 1,
			"widgets": [
				{
					"type": "text_widget",
					"settings": {
						"title": "Time of Last reading",
						"size": "regular",
						"value": "datasources[\"gwaveBuoy\"][\"table\"][\"rows\"][0][2].substring(11,19)",
						"animate": true,
						"units": "UTC time"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "Sea Surface Temperature",
						"size": "regular",
						"value": "datasources[\"gwaveBuoy\"][\"table\"][\"rows\"][0][8]",
						"sparkline": true,
						"animate": true,
						"units": "&deg;C"
					}
				},
				{
					"type": "text_widget",
					"settings": {
						"title": "Significant Wave Height",
						"size": "regular",
						"value": "datasources[\"gwaveBuoy\"][\"table\"][\"rows\"][0][7]",
						"animate": true,
						"units": "cm"
					}
				},
				{
					"type": "google_map",
					"settings": {
						"lat": "datasources[\"gwaveBuoy\"][\"table\"][\"rows\"][0][1]",
						"lon": "datasources[\"gwaveBuoy\"][\"table\"][\"rows\"][0][0]"
					}
				}
			]
		}
	],
	"datasources": [
		{
			"name": "Time Now",
			"type": "clock",
			"settings": {
				"refresh": 1
			}
		},
		{
			"name": "Galway",
			"type": "openweathermap",
			"settings": {
				"location": "Galway, Ireland",
				"units": "metric",
				"refresh": 60
			}
		},
		{
			"name": "ctd",
			"type": "JSON",
			"settings": {
				"url": "http://spiddal.marine.ie/data/spiddal-ctd.json",
				"use_thingproxy": false,
				"refresh": 5,
				"method": "GET"
			}
		},
		{
			"name": "gwaveBuoy",
			"type": "JSON",
			"settings": {
				"url": "http://erddap.marine.ie/erddap/tabledap/IWaveBNetwork.json?longitude,latitude,time,station_id,PeakPeriod,PeakDirection,UpcrossPeriod,SignificantWaveHeight,SeaTemperature&time>=2015-09-14T00:00:00Z&station_id=%22Galway%20Bay%20Wave%20Buoy%22&orderByMax(%22time%22)",
				"use_thingproxy": true,
				"refresh": 600,
				"method": "GET"
			}
		},
		{
			"name": "spidFluor",
			"type": "JSON",
			"settings": {
				"url": "http://spiddal.marine.ie/data/spiddal-fluorometer.json",
				"use_thingproxy": true,
				"refresh": 5,
				"method": "GET"
			}
		}
	],
	"columns": 5
}
